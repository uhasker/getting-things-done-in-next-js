<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>More on HTTP</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="more-on-http"><a class="header" href="#more-on-http">More on HTTP</a></h2>
<div style="text-align: right"> <i> Just return a 200 here, it will be fine. <br> â€” Seconds before disaster </i> </div>
<h3 id="status-codes"><a class="header" href="#status-codes">Status Codes</a></h3>
<p>Responses can have <strong>status codes</strong> attached to them.
These indicate the status of a request.</p>
<p>Each status code is a number that indicates some information about the response.
For example, the status code <code>400</code> represents a <code>Bad Request</code>.</p>
<p>There are a lot of status codes and they're grouped in five classes:</p>
<ul>
<li>the status codes <code>100-199</code> indicate informational responses (and you'll rarely see them)</li>
<li>the status codes <code>200-299</code> indicate successful responses</li>
<li>the status codes <code>300-399</code> indicate redirection responses</li>
<li>the status codes <code>400-499</code> indicate client errors</li>
<li>the status codes <code>500-599</code> indicate server errors</li>
</ul>
<p>Quoting the famous <a href="https://www.reddit.com/r/ProgrammerHumor/comments/2rttnv/http_status_ranges_in_a_nutshell/">HTTP status ranges in a nutshell</a>, you could also rephrase this as:</p>
<ul>
<li><code>100-199</code>: hold on</li>
<li><code>200-299</code>: here you go</li>
<li><code>300-399</code>: go away</li>
<li><code>400-499</code>: you fucked up</li>
<li><code>500-599</code>: I fucked up</li>
</ul>
<p>Let's have a quick look at the most important status codes.</p>
<p>The status code <code>200</code> (<code>OK</code>) is the standard response for a successful HTTP request.</p>
<p>The status code <code>201</code> (<code>Created</code>) is often used for requests where a resource has been successfully created.</p>
<p>The status code <code>400</code> (<code>Bad Request</code>) means that the server can't process the request due to a client error.
For example, a <code>400</code> should be returned if the client has provided the server with a malformed request.</p>
<p>The status code <code>401</code> (<code>Unauthorized</code>) usually means that the client couldn't be successfully authenticated.</p>
<p>The status code <code>403</code> (<code>Forbidden</code>) usually means that the client doesn't have the necessary rights to access the requested content.
Note that there is an important difference between <code>401</code> and <code>403</code>.
The code <code>401</code> means that the client couldn't be authenticated <em>at all</em>, the code <code>403</code> means that the client could be authenticated, but doesn't have the correct access rights.</p>
<p>You've probably heard of the most famous status code <code>404</code> (<code>Not Found</code>).
As the name already says, this means that the server can't find the requested resource (usually because the resource doesn't exist).</p>
<p>The status code <code>405</code> (<code>Method Not Allowed</code>) means that the resource exists, but the client is trying to access it using the wrong method.
This occurs if, for example, a client is trying to send a <code>GET</code> request to a route that only supports <code>POST</code> requests.</p>
<p>The most important status codes for server errors are <code>500</code> (<code>Internal Server Error</code>) and <code>503</code> (<code>Service Unavailable</code>).
The status code <code>500</code> basically indicates a server crash, while <code>503</code> indicates that the server is overloaded.</p>
<p>Here is how you can manually return a status code in Express:</p>
<pre><code class="language-js">app.post('/', (req, res) =&gt; {
  const data = req.body;

  // If the request body is empty, we return status code 400 (Bad Request)
  if (Object.keys(data).length === 0) {
    res.status(400).send('Bad Request: No data provided');
  } else {
    res.status(201).send(`Received data: ${JSON.stringify(data)}`);
  }
});
</code></pre>
<p>Try to <code>curl</code> the endpoint both with an empty and a non-empty object.
For example, you can <code>curl</code> the endpoint with an empty object like this:</p>
<pre><code class="language-sh">curl -X POST -H "Content-Type: application/json" -d '{}' -w '\nStatus: %{http_code}' http://localhost:3000
</code></pre>
<p>The output would be:</p>
<pre><code>Bad Request: No data provided
Status: 400
</code></pre>
<p>Let's also <code>curl</code> the endpoint with a non-empty object like this:</p>
<pre><code class="language-sh">curl -X POST -H "Content-Type: application/json" -d '{"key": "value"}' -w '\nStatus: %{http_code}' http://localhost:3000
</code></pre>
<p>The output would be:</p>
<pre><code>Received data: {"key":"value"}
Status: 201
</code></pre>
<h3 id="headers"><a class="header" href="#headers">Headers</a></h3>
<p>Both requests and responses can have <strong>headers</strong> which provide important information that is not part of the main request or response content.
For example, request headers might contain the version of the browser that is making the request, what languages are accepted, what encodings are accepted etc.</p>
<p>Here is how you can read request headers in Express:</p>
<pre><code class="language-js">app.get('/request-header-example', (req, res) =&gt; {
  const customHeaderValue = req.get('Custom-Header');

  if (customHeaderValue) {
    const responseData = { 'Received-Custom-Header': customHeaderValue };
    res.send(`Received data: ${JSON.stringify(responseData)}`);
  } else {
    res.status(400).send('No Custom-Header provided');
  }
});
</code></pre>
<p>You can set a header in <code>curl</code> like this:</p>
<pre><code class="language-sh">curl -H "Custom-Header: ExampleValue" http://localhost:3000/request-header-example
</code></pre>
<p>You will receive the following response:</p>
<pre><code>Received data: {"Received-Custom-Header":"ExampleValue"}
</code></pre>
<p>Similarly, response headers might contain the type of the content, the date of the response etc.</p>
<p>Here is how you can set response headers in Express:</p>
<pre><code class="language-js">app.get('/response-header-example', (req, res) =&gt; {
  const data = req.body;

  // Add a custom header
  res.set('X-Custom-Header', 'MyHeaderValue');

  res.status(201).send(`Received data: ${JSON.stringify(data)}`);
});
</code></pre>
<p>You can see the response headers in <code>curl</code> by using the <code>-i</code> flag:</p>
<pre><code>curl -i http://localhost:3000/response-header-example
</code></pre>
<p>This will output:</p>
<pre><code>HTTP/1.1 201 Created
X-Powered-By: Express
X-Custom-Header: MyHeaderValue
Content-Type: text/html; charset=utf-8
Content-Length: 17
ETag: W/"11-10nwzUtYNUZcrMxeVU7fTdmCYaI"
Date: Thu, 14 Mar 2024 11:23:03 GMT
Connection: keep-alive
Keep-Alive: timeout=5

Received data: {}
</code></pre>
<p>Note that Express and other web frameworks already set quite a few response headers by default.</p>
<blockquote>
<p>You can also see the response headers in the network tab of your browser if you click on an individual request.</p>
</blockquote>
<h3 id="cookies"><a class="header" href="#cookies">Cookies</a></h3>
<p>HTTP <strong>cookies</strong> are pieces of data that are created by the server, sent to the browser and then saved on the browser.
Cookies can be used for things like authentication, personalization and tracking.</p>
<p>For example, the server might generate a cookie for a logged in user, send it to the browser and then the browser could send the cookie with each request (avoiding the need for the user to log in on every request).</p>
<p>Note that cookies are simply set as part of the headers.
For example, a request might contain a <code>Cookie</code> header containing the cookies it has currently stored.
A response might contain a <code>Set-Cookie</code> header which contains the cookies that the browser should set (or clear).</p>
<p>Let's have a look at a small example.
First, we'll need to install the <code>cookie-parser</code> package in addition to the <code>express</code> package:</p>
<pre><code class="language-sh">pnpm install -g cookie-parser
</code></pre>
<p>Next, we will create an Express application with three routes.
The first route will be a <code>/set-cookie</code> route that will allow us to set a cookie.
The second route will be a <code>/read-cookie</code> route that will allow us to read the cookie.
Finally, we will add a third route <code>/clear-cookie</code> which will allows us to clear the cookie.</p>
<pre><code class="language-js">const express = require('express');
const cookieParser = require('cookie-parser');

const app = express();
const PORT = 3000;

app.use(cookieParser());

// Route to set a cookie
app.get('/set-cookie', (req, res) =&gt; {
  res.cookie('myCookie', 'test', { httpOnly: true });
  res.send('Cookie has been set!');
});

// Route to read the cookie
app.get('/read-cookie', (req, res) =&gt; {
  const myCookie = req.cookies.myCookie;
  if (myCookie) {
    res.send(`myCookie: ${myCookie}`);
  } else {
    res.status(404).send('No cookie found');
  }
});

// Route to clear the cookie
app.get('/clear-cookie', (req, res) =&gt; {
  res.clearCookie('myCookie');
  res.send('Cookie has been cleared');
});

app.listen(PORT, () =&gt; {
  console.log(`Server listening on port ${PORT}...`);
});
</code></pre>
<p>Let's launch the server, open a browser and go to <code>http://localhost:3000/set-cookie</code>.
You should see a message <code>Cookie has been set!</code> and a new key-value pair appearing in your "cookies" tab.</p>
<p>If you now go to <code>http://localhost:3000/read-cookie</code>, you will see <code>myCookie: test</code> on the page.</p>
<p>Finally, if you go to <code>http://localhost:3000/clear-cookie</code>, you will see that the cookie has been cleared.</p>
<h3 id="redirects"><a class="header" href="#redirects">Redirects</a></h3>
<p>The <code>301</code> (<code>Moved Permanently</code>) status code is used for URL redirection.
This basically informs a client that the resource has been <em>permanently</em> moved.
A response with a <code>301</code> status code should contain the URL where the resource has been moved to.</p>
<p>The <code>302</code> (<code>Found</code>) status code is also used for URL redirection, but it indicates to the client that the resource has been <em>temporarily</em> moved.
Again, a response with a <code>302</code> status code should contain the URL where the resource has been moved to.</p>
<p>Let's have a look at an Express example:</p>
<pre><code class="language-js">const express = require('express');
const cookieParser = require('cookie-parser');

const app = express();
const PORT = 3000;

// 301 Redirect (Permanent)
app.get('/permanent-redirect', (req, res) =&gt; {
  res.redirect(301, '/permanent-target');
});

// 302 Redirect (Temporary)
app.get('/temporary-redirect', (req, res) =&gt; {
  res.redirect(302, '/temporary-target');
});

// Target Route for 301 Redirect
app.get('/permanent-target', (req, res) =&gt; {
  res.send('This is the permanent target route');
});

// Target Route for 302 Redirect
app.get('/temporary-target', (req, res) =&gt; {
  res.send('This is the temporary target route');
});

app.listen(PORT, () =&gt; {
  console.log(`Server listening on port ${PORT}...`);
});
</code></pre>
<p>If you open <code>http://localhost:3000/permanent-redirect</code> in your browser, you will see that the address in the browser address bar suddenly changes to <code>http://localhost:3000/permanent-target</code> and you see the content <code>'This is the permanent target route'</code>.
If you open the network tab, you will see that two requests are sent to accomplish this.</p>
<p>First, your browser sends a request to <code>http://localhost:3000/permanent-redirect</code> and receives a response with status code <code>301</code> and the response header <code>Location</code> set to <code>/permanent-target</code>.
Your browser now sends another request to the URL that is indicated in the <code>Location</code> header and receives the actual content.</p>
<p>You will see similar behaviour with the <code>/temporary-redirect</code> and <code>/temporary-target</code> routes.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../chapter3/02-an-http-primer.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../chapter4/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../chapter3/02-an-http-primer.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../chapter4/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
